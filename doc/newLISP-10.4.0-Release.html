<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>newLISP  v.10.4.0 Release Notes </title>

<style type="text/css" media="screen">

h1 {
	font-family:Optima, Georgia, Times New Roman, Times, serif; 
	font-size: 250%;
	font-weight: 500;
	color: #404040;
	}

h2, h3 {
	font-family: Lucida Sans, Helvetica,  sans-serif;
	color: #404040;
	line-height: 120%;
 	}

body, p {
	font-family: Lucida Sans, Helvetica,  sans-serif;
	color: #404040;
	line-height: 120%;
	max-width: 925px;
 	}

tt {
	font-family: Courier;
	color: #505050;
	line-height: 140%;
	}


li {
	margin-bottom: 15px;
	

</style>

</head>

<body>
<h1>newLISP<font size=-2>&#174;</font> v.10.4.0 Stable Release&nbsp;<font color="red" size="-1">rev 2012-2-14</font></h1>

<p>This stable release features a rewritten message queue interface for 
multiprocessing and an extension of the foreign function <tt>import</tt> API. 
This release also fixes bugs and makes efficiency inprovements.</p>


<h3>Additions and changes</h3>
<ul>
<li><tt>import</tt> now has a second syntax to specify return and parameter value
data types. This new extended API usese <a href="http://sourceware.org/libffi/">libffi</a>. 
This extension to the current foreign functions interface is available in all 
standard binary installs of newLISP.</li>

<li>The extended <tt>callback</tt> API allows specifying return and parameter value
data types. Like the extended <tt>import</tt>, the enhanced <tt>callback</tt>
 syntax uses <tt>libffi</tt>. </li>

<li>The <tt>now</tt> time function now returns the GMT offset with opoposite signs,
positive for east and negative for west of the UCT Meridian. The day-of-the-year
number now starts with 1 instead of offset 0. Both changes make <tt>now</tt> more 
ISO 8601 compliant.</li>

<li>Bit 11 - hex 0x400 - in the last field of <tt>sys-info</tt> is set for extended 
FFI enabled versions requiring <tt>libffi</tt>.</li>

<li>The speed of <tt>read-line</tt>, when used with a file handle, has been increased
many times to the same speed as when used with STDIN.</li>

<li>A reworked <tt>send</tt>, <tt>receive</tt> message API is multiple times faster 
and has consistent performance on different OS platforms. The channel for each 
child is now a dual read/write message queue internally using Unix, local domain 
sockets. In previous version only one message could be written with <tt>send</tt>. 
Now mutiple message can be placed into a queue on the same channel and retrieved 
on the receiving end with multiple <tt>receive</tt> statements, until returning 
<tt>nil</tt> when the queue is empty. On the sending side, <tt>send</tt> will return
<tt>nil</tt> when the queue is full.<br/><br/>
New call patterns for <tt>send </tt> and <tt>receive</tt> let the parent process 
filter child PIDs to target only those child processes, which are either ready to 
receive or target those from which messages can be be read. The <tt>(send)</tt> form 
allows the parent process to filter all those child PIDs, which are ready to receive 
messages sent by the parent. The <tt>(receive)</tt> form returns a list of child 
PIDs ready with messages in their sending queues to be read by the parent process.
</li>
<li>The creation of a communications channel between and parent process and 
<tt>spawn</tt>ed child processes for usage with <tt>send</tt> and <tt>receive</tt>, 
is now optional:<br/>
<pre>
    (spawn <em>sym-variable</em> <em>child-process</em> [true])
</pre>
If the <tt>send</tt> or <tt>receive</tt> is used with <em>child-process</em> spawned, the
optional flag must be set to <tt>true</tt>.</li>

<li>The dummy versions of <tt>spawn</tt>, <tt>sync</tt> and <tt>abort</tt> in the 
MS Windows version have been taken out.</li>

<li><tt>struct</tt> allows creating structure data types for usage with the extended
<tt>import</tt> API.</li>

<li>In <tt>unify</tt> the underscore symbol: <tt>_</tt> matches any atom, list or
bound or unbound variable.</li>

<li>The library file <tt>newlisp.dll</tt> is now installed in its old location
in the main <tt>newlisp</tt> program directory. No administrator rights are necessary
for installing in that location. This library is only required for third party
applications, not for newLISP itself.</li>

<li>The minumum Java version to run Guiserver is now Java JRE version 1.6.</li>

</ul>

<h3>Bug fixes</h3>
<ul>
<li>A longstanding bug for ithe list-mode of <tt>net-select</tt> has been
fixed. Now, <tt>net-select</tt> <u>does</u> return socket numbers in the ready 
list not 0's (zeros).</li>
<li>The link feature using <tt>newlisp-x.x.x/util/link.lsp</tt> now also works when 
linking with 64-bit versions of newLISP.</li>
</ul>
<h3>Compatibility with previous versions</h3>
<p>Previous versions using <tt>spawn</tt> together with message functions
<tt>send</tt> and <tt>receive</tt> should now include the <tt>true</tt> flag
in <tt>spawn</tt> calls to enable communications channel between parent and
child processes. <tt>spawn</tt> should specify the optional <tt>true</tt> flag
to enable <tt>send</tt> and <tt>receive</tt> messaging with spawned child
processes. The GMT offset and day-of-the-year values are reported differently.
In all other areas, this version if fully compatible with the 
previous stable release version 10.3.3.</p>
<br/>
<center>&part;</center>

</body>
</html>
